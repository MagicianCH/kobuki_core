<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.19"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Kobuki: Getting Started</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_kobuki.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Kobuki
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">Libraries and tools for the Kobuki robotics platform</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.19 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('en_getting_started_guide.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Getting Started </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="design"></a>
Design</h1>
<p><em>This library does not attempt to provide you with a control loop.</em></p>
<p>The nature of the compute node attached to the Kobuki as well as your application's needs can be extremely varied and have a significant impact on how you build your program. Subsequently, we have left the decision on how to design your application, especially for details around the control loop, up to you. This means the library is simply one of classes, data structures, simple functions and callback-oriented <a class="el" href="en_sigslots_guide.html">sigslots</a>.</p>
<h1><a class="anchor" id="kobukiClass"></a>
The Kobuki Class</h1>
<p>The <a class="el" href="classkobuki_1_1_kobuki.html">kobuki::Kobuki</a> class is the first port of call for developing your kobuki program. Configuration and non-callback modes of interaction are handled via this class. Interactions via callbacks using sigslots is covered especially in the guide on <a class="el" href="en_sigslots_guide.html">sigslots</a>. <br  />
</p>
<h1><a class="anchor" id="kobukiConfiguration"></a>
Configuration</h1>
<p>Kobuki configuration is handled by the <a class="el" href="classkobuki_1_1_parameters.html">kobuki::Parameters</a> class which is passed to the kobuki instance via the kobuki::Kobuki::init() method. Most of the parameters to be configured have sane defaults. The only one that requires frequent configuration is typically the serial <a class="el" href="classkobuki_1_1_parameters.html#a993217236ea68f063f5bc285414408e2">device_port</a>. Note that on some systems you can configure a rule (refer to the <a class="el" href="en_ftdi_guide.html">ftdi serial device guide</a>) for the device port, otherwise you will require one of the usual COM1 or /dev/ttyUSB0 values.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="kobuki_8hpp.html">kobuki_driver/kobuki.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ecl/time.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code" href="class_kobuki_manager.html">KobukiManager</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <a class="code" href="class_kobuki_manager.html#af719c61bfe21c8c3e35320edba20f7aa">KobukiManager</a>() {</div>
<div class="line">    <a class="code" href="classkobuki_1_1_parameters.html">kobuki::Parameters</a> parameters;</div>
<div class="line">    <span class="comment">// change the default device port from /dev/kobuki to /dev/ttyUSB0</span></div>
<div class="line">    parameters.<a class="code" href="classkobuki_1_1_parameters.html#a993217236ea68f063f5bc285414408e2">device_port</a> = <span class="stringliteral">&quot;/dev/ttyUSB0&quot;</span>;</div>
<div class="line">    <span class="comment">// Other parameters are typically happy enough as defaults</span></div>
<div class="line">    <span class="comment">// namespaces all sigslot connection names under this value, only important if you want to</span></div>
<div class="line">    parameters.<a class="code" href="classkobuki_1_1_parameters.html#a0717933338e84bc7907f7e8345e2347e">sigslots_namespace</a> = <span class="stringliteral">&quot;/kobuki&quot;</span>;</div>
<div class="line">    <span class="comment">// Most people will prefer to do their own velocity smoothing/acceleration limiting.</span></div>
<div class="line">    <span class="comment">// If you wish to utilise kobuki&#39;s minimal acceleration limiter, set to true</span></div>
<div class="line">    parameters.<a class="code" href="classkobuki_1_1_parameters.html#ab6eaa092677b34a152c9a11dfd3ff56f">enable_acceleration_limiter</a> = <span class="keyword">false</span>;</div>
<div class="line">    <span class="comment">// If your battery levels are showing significant variance from factory defaults, adjust thresholds.</span></div>
<div class="line">    <span class="comment">// This will affect the led on the front of the robot as well as when signals are emitted by the driver.</span></div>
<div class="line">    parameters.<a class="code" href="classkobuki_1_1_parameters.html#a0c7b04175141d702f520c4a963876143">battery_capacity</a> = 16.5;</div>
<div class="line">    parameters.<a class="code" href="classkobuki_1_1_parameters.html#afbe3833926add7263db592c6b0116b36">battery_low</a> = 14.0;</div>
<div class="line">    parameters.<a class="code" href="classkobuki_1_1_parameters.html#a6332cc2748b6f7095e1eb463a024289d">battery_dangerous</a> = 13.2;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// initialise - it will throw an exception if parameter validation or initialisation fails.</span></div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">      kobuki.init(parameters);</div>
<div class="line">    } <span class="keywordflow">catch</span> ( ecl::StandardException &amp;e ) {</div>
<div class="line">      std::cout &lt;&lt; e.what();</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code" href="classkobuki_1_1_kobuki.html">kobuki::Kobuki</a> kobuki;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">  <a class="code" href="class_kobuki_manager.html">KobukiManager</a> kobuki_manager;</div>
<div class="line">  ecl::Sleep()(5);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>If you compile and run this program, you should hear kobuki's starting up chirp followed immediately by the shutting down chirp.</p>
<h1><a class="anchor" id="kobukiLibraryApi"></a>
Library Api</h1>
<h2><a class="anchor" id="kobukiRawData"></a>
Raw Data</h2>
<p>The kobuki driver runs a background thread which continually retrieves packets from the kobuki, saving the raw data, and additionally doing some processing before updating the current state of the robot.</p>
<p>Raw data can be accessed at any time by one of the following getXXX commands:</p>
<ul>
<li>kobuki::Kobuki::getCoreSensorData</li>
<li>kobuki::Kobuki::getDockIRData</li>
<li>kobuki::Kobuki::getCliffData</li>
<li>kobuki::Kobuki::getCurrentData</li>
<li>kobuki::Kobuki::getGpInputData</li>
<li>kobuki::Kobuki::getInertiaData</li>
<li>kobuki::Kobuki::getRawInertiaData</li>
<li>kobuki::Kobuki::getControllerInfoData</li>
</ul>
<p>The gyro provides both filtered yaw angle as well as unfiltered 3-axis inertial data hence the two calls above.</p>
<h2><a class="anchor" id="kobukiProcessedData"></a>
Processed Data and Status</h2>
<p>The following are convenience methods for accessing the current state of the robot</p>
<ul>
<li>kobuki::Kobuki::batteryStatus</li>
<li>kobuki::Kobuki::getHeading</li>
<li>kobuki::Kobuki::getAngularVelocity</li>
<li>kobuki::Kobuki::versionInfo : hardware, firmware and software version strings.</li>
<li>kobuki::Kobuki::getWheelJointStates</li>
<li><a class="el" href="classkobuki_1_1_kobuki.html#ae31bba2eb5814623c3459db6ac88298e">kobuki::Kobuki::isAlive</a> : true if a kobuki is detected and streaming data.</li>
<li><a class="el" href="classkobuki_1_1_kobuki.html#a0c241c467083cf97b775d90ac4bfabe8">kobuki::Kobuki::isEnabled</a> : true if the motor power is enabled</li>
<li><a class="el" href="classkobuki_1_1_kobuki.html#a0ae91d43985f7732d817bc63f0e9e818">kobuki::Kobuki::isShutdown</a> : true if the worker threads for this driver have been shut down.</li>
</ul>
<h2><a class="anchor" id="kobukiSoftCommands"></a>
Soft Commands</h2>
<ul>
<li>kobuki::Kobuki::resetOdometry</li>
</ul>
<h2><a class="anchor" id="kobukiHardCommands"></a>
Hard Commands</h2>
<ul>
<li>kobuki::Kobuki::setBaseControl</li>
<li>kobuki::Kobuki::setLed</li>
<li>kobuki::Kobuki::setDigitalOutput</li>
<li>kobuki::Kobuki::setExternalPower</li>
<li>kobuki::Kobuki::playSoundSequence</li>
<li>kobuki::Kobuki::setControllerGain</li>
<li>kobuki::Kobuki::getControllerGain</li>
</ul>
<h2><a class="anchor" id="differentialDriverModule"></a>
The Differential Drive Module</h2>
<p>The final function of importance is the <a class="el" href="classkobuki_1_1_kobuki.html#a20913af66616fd0242e38f9ab11228c6">kobuki::Kobuki::updateOdometry</a> method. This updates the current odometry state of the robot, fusing encoder and gyro heading data with the previous known state. For deterministic odometry, it is important this method is called each time a new data packet from the kobuki arrives. Refer to the <a class="el" href="en_simple_example.html">simple control loop example</a> for more information and working code to illustrate. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="aclasskobuki_1_1_parameters_html_a6332cc2748b6f7095e1eb463a024289d"><div class="ttname"><a href="classkobuki_1_1_parameters.html#a6332cc2748b6f7095e1eb463a024289d">kobuki::Parameters::battery_dangerous</a></div><div class="ttdeci">double battery_dangerous</div><div class="ttdoc">Threshold for battery level in danger of depletion [13.2V].</div><div class="ttdef"><b>Definition:</b> parameters.hpp:60</div></div>
<div class="ttc" id="aclass_kobuki_manager_html_af719c61bfe21c8c3e35320edba20f7aa"><div class="ttname"><a href="class_kobuki_manager.html#af719c61bfe21c8c3e35320edba20f7aa">KobukiManager::KobukiManager</a></div><div class="ttdeci">KobukiManager()</div><div class="ttdoc">Default constructor, needs initialisation.</div><div class="ttdef"><b>Definition:</b> simple_keyop.cpp:98</div></div>
<div class="ttc" id="aclasskobuki_1_1_parameters_html_a0717933338e84bc7907f7e8345e2347e"><div class="ttname"><a href="classkobuki_1_1_parameters.html#a0717933338e84bc7907f7e8345e2347e">kobuki::Parameters::sigslots_namespace</a></div><div class="ttdeci">std::string sigslots_namespace</div><div class="ttdoc">The first part of a sigslot connection namespace [&quot;/kobuki&quot;].</div><div class="ttdef"><b>Definition:</b> parameters.hpp:55</div></div>
<div class="ttc" id="aclasskobuki_1_1_parameters_html_a0c7b04175141d702f520c4a963876143"><div class="ttname"><a href="classkobuki_1_1_parameters.html#a0c7b04175141d702f520c4a963876143">kobuki::Parameters::battery_capacity</a></div><div class="ttdeci">double battery_capacity</div><div class="ttdoc">Capacity voltage of the battery [16.5V].</div><div class="ttdef"><b>Definition:</b> parameters.hpp:58</div></div>
<div class="ttc" id="aclass_kobuki_manager_html"><div class="ttname"><a href="class_kobuki_manager.html">KobukiManager</a></div><div class="ttdoc">Keyboard remote control for our robot core (mobile base).</div><div class="ttdef"><b>Definition:</b> buttons.cpp:29</div></div>
<div class="ttc" id="aclasskobuki_1_1_parameters_html_a993217236ea68f063f5bc285414408e2"><div class="ttname"><a href="classkobuki_1_1_parameters.html#a993217236ea68f063f5bc285414408e2">kobuki::Parameters::device_port</a></div><div class="ttdeci">std::string device_port</div><div class="ttdoc">The serial device port name [/dev/kobuki].</div><div class="ttdef"><b>Definition:</b> parameters.hpp:54</div></div>
<div class="ttc" id="aclasskobuki_1_1_kobuki_html"><div class="ttname"><a href="classkobuki_1_1_kobuki.html">kobuki::Kobuki</a></div><div class="ttdoc">The core kobuki driver class.</div><div class="ttdef"><b>Definition:</b> kobuki.hpp:88</div></div>
<div class="ttc" id="aclasskobuki_1_1_parameters_html"><div class="ttname"><a href="classkobuki_1_1_parameters.html">kobuki::Parameters</a></div><div class="ttdoc">Parameter list and validator for the kobuki.</div><div class="ttdef"><b>Definition:</b> parameters.hpp:37</div></div>
<div class="ttc" id="aclasskobuki_1_1_parameters_html_ab6eaa092677b34a152c9a11dfd3ff56f"><div class="ttname"><a href="classkobuki_1_1_parameters.html#ab6eaa092677b34a152c9a11dfd3ff56f">kobuki::Parameters::enable_acceleration_limiter</a></div><div class="ttdeci">bool enable_acceleration_limiter</div><div class="ttdoc">Enable or disable the acceleration limiter [true].</div><div class="ttdef"><b>Definition:</b> parameters.hpp:57</div></div>
<div class="ttc" id="akobuki_8hpp_html"><div class="ttname"><a href="kobuki_8hpp.html">kobuki.hpp</a></div><div class="ttdoc">Device driver core interface.</div></div>
<div class="ttc" id="aclasskobuki_1_1_parameters_html_afbe3833926add7263db592c6b0116b36"><div class="ttname"><a href="classkobuki_1_1_parameters.html#afbe3833926add7263db592c6b0116b36">kobuki::Parameters::battery_low</a></div><div class="ttdeci">double battery_low</div><div class="ttdoc">Threshold for battery level warnings [14.0V].</div><div class="ttdef"><b>Definition:</b> parameters.hpp:59</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.19 </li>
  </ul>
</div>
</body>
</html>
